---
title: "word2vec-tsne"
author: "Yusuke Fukasawa"
date: "2017/3/15"
output: html_document
---

word2vecで得られたベクトルをt-SNEで2次元に圧縮して可視化する。

```{r}
require(tsne)
vector<-read.csv('dena_vector.csv',encoding = 'utf-8',header = F)
network<-read.csv('expand_grid_demand_mb.csv',encoding = 'utf-8')

#tSNE
require(Rtsne)
set.seed(1) # 再現性の確保
dena.tsne <- Rtsne(vector, check_duplicates = FALSE, verbose=TRUE)
dena.tsne.vector<-data.frame(dena.tsne$Y)
dena.tsne.vector$label<-vector$V1

#merge
dena.tsne.vector.merge<-merge(dena.tsne.vector,network,by.x='label',by.y='label')
#5以下のクラスは全部etcにする
list<-data.frame(summary(dena.tsne.vector.merge$modularity_class))
colnames(list)<-'Freq'
list$modularity<-row.names(list)
list$mc2<-0
k<-1
for(i in 1:length(list$Freq)){
  if(list$Freq[i]<=5){
    list$mc2[i]<-'etc'
  }else{
    list$mc2[i]<-k
    k<-k+1
  }
}
dena.tsne.vector.merge2<-merge(dena.tsne.vector.merge,list,by.x='modularity_class',by.y='modularity',all=T)

#scatterplot
require(scatterD3)
require(RColorBrewer)
scatterD3(data = dena.tsne.vector.merge2, x = X1, y = X2, lab = label,col_var = mc2)
```